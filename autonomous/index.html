<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="INFOTIV" /><link rel="canonical" href="https://infotiv-research.github.io/gokart-documentation/autonomous/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Autonomous Drive - Infotiv Autonomous Platform</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Autonomous Drive";
        var mkdocs_page_input_path = "autonomous.md";
        var mkdocs_page_url = "/gokart-documentation/autonomous/";
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Infotiv Autonomous Platform
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../scope/">Scope and Goal</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Architecture</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../platform/">Automotive Platform</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bodyelec/">Body Electronics</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Autonomous Drive</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#openpilot-integration">OpenPilot Integration</a>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Components</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../components/">HW and Board Components</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../interfaces/">Interfaces and Sensors</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../software/">Software Repositories</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Usage Manual</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../start/">Start the GoKart</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../issues-todo/">Known Issues</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dev/">For Developers</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../projects/">Thesis Projects</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../project-proposal/">Project Proposal</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../contact/">Contact Infotiv</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../terms/">Glossary of Terms</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../changelog/">ChangeLog</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Infotiv Autonomous Platform</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Architecture &raquo;</li><li>Autonomous Drive</li>
    <li class="wy-breadcrumbs-aside">
        <a href="https://github.com/infotiv-research/gokart-documentation/edit/master/docs/autonomous.md"> Edit on infotiv-research/gokart-documentation</a>
    </li>
  </ul>
  <hr/>
</div>

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="autonomous-drive">Autonomous Drive<a class="headerlink" href="#autonomous-drive" title="Permanent link">&para;</a></h1>
<p>The Autonomous Drive in GoKart is based on OpenPilot project. </p>
<blockquote>
<p>“openpilot is an open source driver assistance system. Currently, openpilot performs the functions of Adaptive Cruise Control (ACC), Automated Lane Centering (ALC), Forward Collision Warning (FCW), and Lane Departure Warning (LDW) for a growing variety of supported car makes, models, and model years. In addition, while openpilot is engaged, a camera-based Driver Monitoring (DM) feature alerts distracted and asleep drivers. See more about the vehicle integration and limitations.” (https://github.com/commaai/openpilot)</p>
</blockquote>
<h2 id="openpilot-integration">OpenPilot Integration<a class="headerlink" href="#openpilot-integration" title="Permanent link">&para;</a></h2>
<p>The Integration uses code from the bridge that allows it to run OpenPilot in the CARLA simulator. The modification made it possible to use the camera images and use of <code>gokart_controller</code> python library to control the GoKart through ROS APIs.</p>
<p><img alt="OpenPilot driving the GoKart!" src="../assets/images/op_gokart.png" title="OpenPilot driving the GoKart" /></p>
<pre><code class="language-bash">git clone git@github.com:ebadi/openpilot_gokart.git --recursive
cd openpilot-webcam/tools/sim
./build_container.sh
./start_openpilot_docker.sh
</code></pre>
<p>If there is any issue with the images shown on the dashboard (black image on dashboard or use of the incorrect camera):</p>
<ul>
<li>Make sure that the camera is connected to the machine (use <code>cheese</code> to verify that). </li>
<li>Make sure that the camera device (<code>--device /dev/videoX</code>) is passed to the docker container in <code>start_openpilot_docker.sh</code> </li>
<li>check that the right camera is selected in the <code>gokart.py</code>:</li>
</ul>
<pre><code>def webcam(camerad: Camerad, exit_event: threading.Event):
  ...
  cap = cv2.VideoCapture(6) #set camera ID here, index X in /dev/videoX
  ...
</code></pre>
<p>Running the docker container results in several scripts to be executed in parallel (<code>see tmux_script.sh</code>). You can switch between them using <code>~</code> key or the combination of keys like: <code>~ + 1</code> for terminal one, <code>~ + 2</code> for terminal two, etc. </p>
<p>If there are communication issues please make sure that the IP addresses and the hostname for ROS_MASTER_URI, ROS_IP and node_uri are correctly specified in <code>tmux_script.sh</code> and <code>gokart.py</code>. </p>
<p><strong> Please note that it is not always possible to use the hostname <code>dobby.local</code> inside the docker. </strong></p>
<p>To stop the docker container:</p>
<pre><code class="language-bash">docker kill openpilot_client
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../bodyelec/" class="btn btn-neutral float-left" title="Body Electronics"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../components/" class="btn btn-neutral float-right" title="HW and Board Components">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../bodyelec/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../components/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
